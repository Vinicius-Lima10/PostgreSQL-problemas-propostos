select c.name, (sum(p.amount)) as "sum"
from products as p
join categories as c
on c.id = p.id_categories
group by c.name